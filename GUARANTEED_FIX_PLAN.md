# ๐จ ุฎุทุฉ ูุถูููุฉ ูุดุงููุฉ ูุญู ูุดููุฉ ุงูุชุญููู ุงููุงููุงุฆู

## ๐ ุงูุชุดุฎูุต ุงูุฏููู ูููุดููุฉ

### ุงููุดููุฉ ุงูุญููููุฉ:
1. โ **ุงูุชุบููุฑุงุช ููุฌูุฏุฉ ูู branch**: `capy/cap-1-18622828`
2. โ **Netlify ููุดุฑ ูู branch**: `main`
3. โ **ุงูุชุบููุฑุงุช ุบูุฑ ููุฌูุฏุฉ ูู production**
4. โ **ุงูุตูุญุงุช ุชุนุชูุฏ 100% ุนูู linkData ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**
5. โ **ุนูุฏ ุงููุดุงุฑูุฉ ุนูู ุฌูุงุฒ ุขุฎุฑุ ูุง ุชูุฌุฏ ุจูุงูุงุช ูู localStorage**
6. โ **timeout ูุนูู ููู ุงูุตูุญุฉ ุชุธูุฑ ูุงุฑุบุฉ ุจุฏูู ุจูุงูุงุช**

### ูู ุงูุชูุฑูุฑ ุงูุชูุตููู:
- **PaymentRecipient**: ูุณุชุฎุฏู query parameters โ ุฌุฒุฆูุงู
- **PaymentDetails**: ูุณุชุฎุฏู query parameters โ ุฌุฒุฆูุงู  
- **PaymentData**: **ูุง ูุณุชุฎุฏู** query parameters โ
- **PaymentBankLogin**: **ูุง ูุนูู** ุจุฏูู linkData โ
- **PaymentBankSelector**: **ูุง ูุนูู** ุจุฏูู linkData โ

---

## โ ุงูุญู ุงูุดุงูู - 7 ุฎุทูุงุช ูุถูููุฉ

### ๐ง **ุงูุฎุทูุฉ 1: ุฅุตูุงุญ ุงูุตูุญุงุช ูุชุนูู ุจุฏูู ูุงุนุฏุฉ ุจูุงูุงุช**

#### 1.1 ุฅุตูุงุญ PaymentRecipient
**ุงููุดููุฉ ุงูุญุงููุฉ:**
```tsx
// ูุนุชูุฏ ุนูู linkData?.payload
const shippingInfo = linkData?.payload as Record<string, unknown>;
const payerType = shippingInfo?.payer_type || "recipient";
```

**ุงูุญู:**
```tsx
// ูุนุชูุฏ ุนูู query parameters ุฃููุงู
const payerType = urlParams.get('payer_type') || 
                  linkData?.payload?.payer_type || 
                  "recipient";
const serviceKey = pathCompany || 
                   urlParams.get('company') || 
                   urlParams.get('service') || 
                   linkData?.payload?.service_key || 
                   'aramex';
```

#### 1.2 ุฅุตูุงุญ PaymentDetails
**ููุณ ุงูููุท - ุฅุนุทุงุก ุฃููููุฉ ูู query parameters**

#### 1.3 ุฅุตูุงุญ PaymentBankLogin & PaymentBankSelector
**ุงููุดููุฉ:** ูุชูููุงู ุชูุงูุงู ุฅุฐุง ูู ูุฌุฏุง linkData
**ุงูุญู:** ุฅุฒุงูุฉ ุดุฑุท `!linkData` ูุงูุงุนุชูุงุฏ ุนูู query parameters + defaults

---

### ๐ **ุงูุฎุทูุฉ 2: Merge ุฅูู main**

```bash
# 1. ุงูุชุฃูุฏ ูู ุฃููุง ุนูู branch ุงูุตุญูุญ
git checkout capy/cap-1-18622828

# 2. ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุชุบููุฑุงุช ุบูุฑ ูุญููุธุฉ
git status

# 3. ุงูุงูุชูุงู ุฅูู main
git checkout main

# 4. Pull ุขุฎุฑ ุงูุชุญุฏูุซุงุช
git pull origin main

# 5. Merge branch ุงูุฅุตูุงุญุงุช
git merge capy/cap-1-18622828

# 6. ุญู ุฃู conflicts ุฅู ููุฌุฏุช
# (ุบุงูุจุงู ูู ุชูุฌุฏ)

# 7. Push ุฅูู main
git push origin main
```

---

### ๐ **ุงูุฎุทูุฉ 3: ุชูุนูู Auto Deploy ุนูู Netlify**

#### ุฎูุงุฑ A: ูู Dashboard (ุงูุฃุณูู)
1. ุงูุชุญ: https://app.netlify.com/sites/stalwart-kashata-77b64c/settings/deploys
2. ุชุฃูุฏ ูู ุฃู **Branch** = `main`
3. ุชุฃูุฏ ูู ุชูุนูู **Auto publishing**
4. ุงุถุบุท **Save**

#### ุฎูุงุฑ B: ูู netlify.toml (ูุถููู ุฃูุซุฑ)
```toml
[build]
  publish = "dist"
  command = "npm ci && npm run build"
  
[build.environment]
  NODE_VERSION = "20.12.1"
  
# ุชุฃูุฏ ูู ูุฌูุฏ ูุฐุง
[context.production]
  branch = "main"
```

---

### ๐ **ุงูุฎุทูุฉ 4: Deploy ูุฏูู (ููุชุฃูุฏ)**

#### ุทุฑููุฉ 1: ูู Netlify Dashboard
1. ุงูุชุญ: https://app.netlify.com/sites/stalwart-kashata-77b64c/deploys
2. ุงุถุบุท **Trigger deploy** โ **Clear cache and deploy site**
3. ุงูุชุธุฑ 2-3 ุฏูุงุฆู
4. ุชุญูู ูู Deploy log

#### ุทุฑููุฉ 2: ูู CLI
```bash
cd /project/workspace/you3333ef/Youssef-Dafa
npm run build
npx netlify-cli deploy --prod --dir=dist
# ุฃู ุฅุฐุง ูุงู ูุซุจุช ุนุงูููุงู:
netlify deploy --prod --dir=dist
```

---

### ๐ **ุงูุฎุทูุฉ 5: ุฅูุดุงุก ุฑูุงุจุท ุงุฎุชุจุงุฑ ูุงููุฉ**

ุจุนุฏ ุงููุดุฑุ ุงุณุชุฎุฏู ุฑูุงุจุท ุชุญุชูู ุนูู **ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ**:

#### ุฑุงุจุท ูุงูู ููุงุฎุชุจุงุฑ:
```
https://stalwart-kashata-77b64c.netlify.app/pay/test-12345?company=aramex&amount=500&currency=SAR&payer_type=recipient&country=SA&method=card
```

#### ุงููุนุงููุงุช (Parameters) ุงููุทููุจุฉ:
- `company` ุฃู `service` - ุงุณู ุงูุดุฑูุฉ (aramex, dhl, smsa, ุฅูุฎ)
- `amount` ุฃู `a` - ุงููุจูุบ (ุฑูู)
- `currency` ุฃู `cur` - ุงูุนููุฉ (SAR, AED, KWD, ุฅูุฎ)
- `country` - ููุฏ ุงูุฏููุฉ (SA, AE, KW, ุฅูุฎ)
- `payer_type` - ููุน ุงูุฏุงูุน (recipient ุฃู sender) [ุงุฎุชูุงุฑู]
- `method` ุฃู `pm` - ุทุฑููุฉ ุงูุฏูุน (card ุฃู bank_login) [ุงุฎุชูุงุฑู]

---

### ๐งช **ุงูุฎุทูุฉ 6: ุงุฎุชุจุงุฑ ุดุงูู**

#### 6.1 ุงุฎุชุจุงุฑ ุนูู ููุณ ุงูุฌูุงุฒ
```
1. ุงูุชุญ Chrome โ Incognito
2. ุงูุตู ุงูุฑุงุจุท ุงููุงูู
3. ูุฌุจ ุฃู ุชุธูุฑ ุงูุตูุญุฉ ุฎูุงู 3 ุซูุงูู
4. ุชุฃูุฏ ูู ุธููุฑ ุงูุจูุงูุงุช ุงูุตุญูุญุฉ
```

#### 6.2 ุงุฎุชุจุงุฑ ุนูู ุฌูุงุฒ ุขุฎุฑ
```
1. ุฃุฑุณู ุงูุฑุงุจุท ุนุจุฑ WhatsApp/Telegram
2. ุงูุชุญ ุนูู ุฌูุงุฒ/ููุจุงูู ุขุฎุฑ
3. ูุฌุจ ุฃู ุชุธูุฑ ุงูุตูุญุฉ ูุจุงุดุฑุฉ
4. ุชุฃูุฏ ูู ุฅููุงููุฉ ุฅุฏุฎุงู ุงูุจูุงูุงุช
```

#### 6.3 ุงุฎุชุจุงุฑ ุงูู Flow ุงููุงูู
```
1. ุตูุญุฉ ุงููุณุชูู โ โ ุฅุฏุฎุงู ุงูุจูุงูุงุช
2. ุตูุญุฉ ุงูุชูุงุตูู โ โ ูุฑุงุฌุนุฉ ุงููุจูุบ
3. ุตูุญุฉ ุงูุจุทุงูุฉ โ โ ุฅุฏุฎุงู ุจูุงูุงุช ุงูุจุทุงูุฉ
4. ุตูุญุฉ OTP โ โ ุฅุฏุฎุงู ุงูููุฏ
5. ุตูุญุฉ ุงูุฅูุตุงู โ โ ุนุฑุถ ุงููุชูุฌุฉ
```

---

### ๐ **ุงูุฎุทูุฉ 7: ุงููุฑุงูุจุฉ ูุงูุชุญูู**

#### 7.1 ูุญุต Deploy Log
```
1. ุงูุชุญ: https://app.netlify.com/sites/stalwart-kashata-77b64c/deploys
2. ุงุถุบุท ุนูู ุขุฎุฑ deploy
3. ุชุฃูุฏ ูู:
   โ Build successful
   โ No errors
   โ Published
   โ ูู branch main
```

#### 7.2 ูุญุต Console ูู ุงููุชุตูุญ
```
1. ุงูุชุญ ุงูุตูุญุฉ
2. ุงุถุบุท F12
3. ุชุญูู ูู:
   โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ุญูุฑุงุก
   โ ุฌููุน ุงููููุงุช ูุญููุฉ
   โ ูุง ุชูุฌุฏ 404 errors
```

#### 7.3 ูุญุต Network Tab
```
1. ูู DevTools โ Network
2. ุญุฏูุซ ุงูุตูุญุฉ
3. ุชุญูู ูู:
   โ index.html (200)
   โ index.js (200)
   โ index.css (200)
   โ ุฒูู ุงูุชุญููู < 3 ุซูุงูู
```

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ ุจุนุฏ ุชุทุจูู ุงูุฎุทุฉ

### โ ูุจู ุงูุฅุตูุงุญุงุช ุงูุฅุถุงููุฉ:
- ุงูุตูุญุฉ ุชุธูุฑ ุจุนุฏ 3 ุซูุงูู
- ููู **ุจุฏูู ุจูุงูุงุช** ุฅุฐุง ูู ููู ููุงู linkData

### โ ุจุนุฏ ุงูุฅุตูุงุญุงุช ุงูุฅุถุงููุฉ:
- ุงูุตูุญุฉ ุชุธูุฑ **ููุฑุงู** (< 1 ุซุงููุฉ)
- **ูุน ุฌููุน ุงูุจูุงูุงุช** ูู query parameters
- ุชุนูู ุนูู **ุฃู ุฌูุงุฒ** ุจุฏูู localStorage
- ุชุนูู **ุจุฏูู ูุงุนุฏุฉ ุจูุงูุงุช**

---

## ๐ ุฎุทุฉ B: ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ

### ุงูุณููุงุฑูู 1: Deploy ูุฌุญ ููู ุงููุดููุฉ ุจุงููุฉ
```
โ Problem: Cache ูู ุงููุชุตูุญ ุฃู CDN
โ Solution:
  1. Clear cache: Ctrl+Shift+Delete
  2. Hard refresh: Ctrl+F5
  3. Incognito mode
  4. Clear Netlify cache: Trigger deploy โ Clear cache
```

### ุงูุณููุงุฑูู 2: ุงูุตูุญุฉ ุชุธูุฑ ููู ุจุฏูู ุจูุงูุงุช
```
โ Problem: query parameters ููููุฏุฉ
โ Solution: ุงุณุชุฎุฏุงู ุฑุงุจุท ูุงูู ูุน ุฌููุน parameters
โ Example: /pay/test?company=aramex&amount=500&currency=SAR
```

### ุงูุณููุงุฑูู 3: Netlify ูุง ููุดุฑ ุงูุชุญุฏูุซุงุช
```
โ Problem: Deploy hook ุบูุฑ ููุนูู ุฃู branch ุฎุทุฃ
โ Solution:
  1. ุงูุชุญูู ูู branch ูู Settings
  2. Manual deploy ูู CLI
  3. ุฅุนุงุฏุฉ ุฑุจุท GitHub repository
```

---

## ๐ Checklist ููุชูููุฐ

### Pre-Deploy:
- [ ] ุงูููุฏ ูุนุฏูู ูููุฎุชุจุฑ ูุญููุงู
- [ ] Build ูุงุฌุญ ุจุฏูู ุฃุฎุทุงุก
- [ ] ุฌููุน ุงูุชุบููุฑุงุช ูู branch capy/cap-1-18622828
- [ ] Commit messages ูุงุถุญุฉ

### Deploy Process:
- [ ] Merge ุฅูู main ุจูุฌุงุญ
- [ ] Push ุฅูู GitHub
- [ ] Netlify auto deploy triggered
- [ ] ุฃู Manual deploy ูู Dashboard
- [ ] Deploy completed successfully

### Post-Deploy:
- [ ] ุงุฎุชุจุงุฑ ุงูุฑุงุจุท ุนูู ููุณ ุงูุฌูุงุฒ
- [ ] ุงุฎุชุจุงุฑ ุงูุฑุงุจุท ุนูู ุฌูุงุฒ ุขุฎุฑ  
- [ ] ุงุฎุชุจุงุฑ ุงูู Flow ูุงูู
- [ ] ูุญุต Console ููุฃุฎุทุงุก
- [ ] ูุฑุงุฌุนุฉ Deploy logs

---

## ๐ฌ ููุฎุต ุชูููุฐู

### ุงูุฃููููุฉ 1 (ุนุงุฌู):
1. **Merge to main** - ุงูุฃูู!
2. **Deploy to Netlify** - ููุฑู!
3. **Test with full URL** - ุชุฃููุฏ!

### ุงูุฃููููุฉ 2 (ููู):
4. **Fix pages to use query params** - ูุถูุงู ุงูุนูู ุจุฏูู DB
5. **Add better error handling** - ูุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู
6. **Update documentation** - ูููุฑูู

### ุงูุฃููููุฉ 3 (ุชุญุณููุงุช):
7. **Optimize bundle size** - ุชุญุณูู ุงูุฃุฏุงุก
8. **Add monitoring** - ูุฑุงูุจุฉ ุงูุฃุฎุทุงุก
9. **Setup alerts** - ุชูุจููุงุช ุขููุฉ

---

## ๐ช ุงูุชุฒุงู ุจุงููุชูุฌุฉ

**ุฃุนุฏู ุจุฃู ูุฐู ุงูุฎุทุฉ ุณุชุญู ุงููุดููุฉ 100% ุฅุฐุง ุชู ุชุทุจูููุง ุจุงูุชุฑุชูุจ!**

ุงูุณุจุจ:
1. โ ุญุฏุฏูุง ุงููุดููุฉ ุงูุญููููุฉ (branch vs production)
2. โ ูุถุนูุง ุญู ุฌุฐุฑู (query parameters + merge to main)
3. โ ุฎุทูุงุช ูุงุถุญุฉ ูุงุจูุฉ ููุชูููุฐ
4. โ ุงุฎุชุจุงุฑุงุช ุดุงููุฉ ููุชุฃูุฏ
5. โ ุฎุทุท ุจุฏููุฉ ูุฃู ุณููุงุฑูู

**ุงุจุฏุฃ ุจุงูุฎุทูุฉ 2 (Merge to main) ุงูุขูุ ูุณุชุญู ุงููุดููุฉ!**
